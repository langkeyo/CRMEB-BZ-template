<template>
  <view class="account-security-page">
    <!-- 顶部导航栏 -->
    <view class="header">
      <view class="title">账号与安全</view>
    </view>
    
    <!-- 分割线 -->
    <view class="divider"></view>
    
    <!-- 账号安全设置项 -->
    <view class="settings-list">
      <!-- 手机号 -->
      <view class="settings-item" @click="showChangePhoneModal">
        <view class="item-icon">
          <image src="/static/images/user/phone_icon.svg" mode="aspectFit"></image>
        </view>
        <view class="item-content">
          <view class="item-text">手机号</view>
          <view class="item-value">{{ maskPhone }}</view>
        </view>
        <view class="arrow-icon">
          <image src="/static/images/user/arrow_right_small.svg" mode="aspectFit"></image>
        </view>
      </view>
      
      <!-- 修改密码 -->
      <view class="settings-item" @click="goToChangePassword">
        <view class="item-icon">
          <image src="/static/images/user/lock_icon.svg" mode="aspectFit"></image>
        </view>
        <view class="item-content">
          <view class="item-text">修改密码</view>
        </view>
        <view class="arrow-icon">
          <image src="/static/images/user/arrow_right_small.svg" mode="aspectFit"></image>
        </view>
      </view>
    </view>
    
    <!-- 底部安全区域 -->
    <view class="safe-area-bottom"></view>
    
    <!-- 更换手机号弹窗 -->
    <view class="modal-overlay" v-if="isChangePhoneModalVisible" @click="hideChangePhoneModal"></view>
    <view class="change-phone-modal" v-if="isChangePhoneModalVisible">
      <view class="modal-content">
        <view class="modal-title">更换已绑定的手机号</view>
        <view class="modal-desc">当前绑定的手机号码为{{ maskPhone }}</view>
        <view class="modal-buttons">
          <view class="btn-cancel" @click="hideChangePhoneModal">取消</view>
          <view class="btn-confirm" @click="goToChangeMobile">更换</view>
        </view>
      </view>
    </view>
  </view>
</template>

<script>
export default {
  data() {
    return {
      userInfo: {
        phone: '18512343652'
      },
      isChangePhoneModalVisible: false
    }
  },
  computed: {
    maskPhone() {
      if (!this.userInfo.phone) return '';
      return this.userInfo.phone.replace(/(\d{3})\d{4}(\d{4})/, '$1****$2');
    }
  },
  methods: {
    goToChangePassword() {
      uni.navigateTo({
        url: '/pages/users/user_settings/change_password'
      });
    },
    showChangePhoneModal() {
      this.isChangePhoneModalVisible = true;
    },
    hideChangePhoneModal() {
      this.isChangePhoneModalVisible = false;
    },
    goToChangeMobile() {
      this.hideChangePhoneModal();
      uni.navigateTo({
        url: '/pages/users/user_phone/index?type=1'
      });
    }
  }
}
</script>

<style lang="scss">
.account-security-page {
  min-height: 100vh;
  background-color: #FFFFFF;
  
  .header {
    padding: 44px 15px 15px;
    position: relative;
    
    .title {
      font-size: 18px;
      color: #1A1A1A;
      font-weight: 400;
      text-align: center;
    }
  }
  
  .divider {
    height: 0.5px;
    background-color: #F2F2F2;
    width: 100%;
  }
  
  .settings-list {
    padding: 0 15px;
    
    .settings-item {
      display: flex;
      align-items: center;
      padding: 15px 0;
      position: relative;
      box-shadow: 0px 0.5px 0px 0px rgba(245, 245, 245, 1);
      
      .item-icon {
        width: 20px;
        height: 20px;
        margin-right: 10px;
        
        image {
          width: 100%;
          height: 100%;
        }
      }
      
      .item-content {
        flex: 1;
        
        .item-text {
          font-size: 16px;
          color: #4D4D4D;
          font-weight: 400;
          line-height: 1.4;
        }
        
        .item-value {
          font-size: 14px;
          color: #B3B3B3;
          font-weight: 400;
          line-height: 1.4;
        }
      }
      
      .arrow-icon {
        width: 16px;
        height: 16px;
        
        image {
          width: 100%;
          height: 100%;
        }
      }
    }
  }
  
  .safe-area-bottom {
    height: 34px;
  }
  
  /* 弹窗样式 */
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 9;
  }
  
  .change-phone-modal {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    z-index: 10;
    
    .modal-content {
      background-color: #FFFFFF;
      border-radius: 10px;
      padding: 20px;
      
      .modal-title {
        font-size: 18px;
        color: #1A1A1A;
        text-align: center;
        margin-bottom: 10px;
      }
      
      .modal-desc {
        font-size: 16px;
        color: #1A1A1A;
        margin-bottom: 20px;
        text-align: center;
      }
      
      .modal-buttons {
        display: flex;
        justify-content: space-between;
        
        .btn-cancel, .btn-confirm {
          flex: 1;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 14px;
          border-radius: 123px;
        }
        
        .btn-cancel {
          color: #999999;
          border: 0.5px solid #999999;
          margin-right: 10px;
        }
        
        .btn-confirm {
          color: #FE8D00;
          border: 0.5px solid #FE8D00;
        }
      }
    }
  }
}
</style> 